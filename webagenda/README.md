## Generating the Schedule for the Website

This directory contains the data files and code used to generate the schedule for the NAACL official website.

### Requirements

Python 3.6+ with:

- [BeautifulSoup4](https://pypi.org/project/beautifulsoup4/)
- [lxml](https://pypi.org/project/lxml/)

### Contents 

There are three main files that support the schedule on the website:

1. `generate.py` : This is the main driver script that generates the schedule markdown file for the repository. It takes as input a single JSON configuration file that contains the following fields:
    
    - `order_file` : The manually combined order file for the main conference.

    - `mapping_file` : File mapping the anthology IDs to the START / order file IDs for the main conference.

    - `xml_file` : The XML file from the Anthology containing the titles, authors, abstracts, and anthology URLs for the items in the main conference.

    - `extra_metadata_file` : An optional TSV file containing the title, authors, and abstracts for the main conference items that are not in the anthology (e.g., TACL papers, SRW non-archival workshop papers, etc.)
    
    - `plenary_info_file` : Another optional TSV file containing additional info about some of the plenary sessions (e.g., keynote abstracts etc.)

    - `pdf_icons` : A boolean indicating whether to generate icons in the schedule that link to anthology PDFs or PDFs specified in the extra metadata file.

    - `video_icons` : A boolean indicating whether to generate icons in the schedule that link to the talk videos hosted on Vimeo/YouTube or other video platforms.

For more details on how this script works, please refer to the code and the comments in the script.

2. `frontmatter.md` : This markdown document contains the Jekyll frontmatter that needs to be appended on top of the HTML generated by `generate.py` to generate a valid markdown file that will be rendered properly by Jekyll. This file expected by `generate.py` to live in the same directory without being provided explicitly as input.

3. `assets/js/schedule.js` : This is the core JavaScript code that powers the official schedule page on the NAACL website. It allows a user to expand and collapse various sessions, shows them which papers conflict with each other as they hover on them, allows them to select the papers they are interested in, and, finally, generates a PDF with the user's customized schedule. The code uses the following JavaScript libraries:
    - [jQuery](https://jquery.com)
    - [jsPDF](https://parall.ax/products/jspdf) along with the amazingly useful [autotable plugin](https://github.com/simonbengtsson/jsPDF-AutoTable)
    - [Altertify](https://alertifyjs.com)
    - [fold-to-ascii](https://github.com/mplatt/fold-to-ascii)

### Generating the Schedule

First, download the spreadsheets given by the Program Chairs. Save them to `data/raw-*`.

Then, process the downloaded files by running the following command at the top level of the cloned repository:

```
python extract_data.py
```

Then use the following command to generate the schedule markdown file at `_pages/program/schedule.md` for the website:

```
python webagenda/generate.py webagenda/config.json _pages/output/schedule.md
```

The config file already adds the PDF links where available. To add the video icons where available, modify the config file to have the value for `video_icons` field to be `true`. 
